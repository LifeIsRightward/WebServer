<%@ page language="java" contentType="text/html; charset=EUC-KR"
    pageEncoding="EUC-KR"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="EUC-KR">
<title>Profile</title>
</head>
<body>
	<%@ page import = "javabean.*" %>
	
	<% 
		String uid = ""; 
		String pw = "";
		String email = "";
		String name = "";
		String age = "";
		String sex = "";
		uid = request.getParameter("uid");
		
		if(uid != null){
			String idnum = uid;
			memberDBCP mDBCP = new memberDBCP();
			member se = mDBCP.getMember(idnum);
			
			pw = se.getPassword();
			email = se.getEmail();
			name = se.getName();
			age = se.getAge();
			sex = se.getSex();
		}
		
		String action = request.getParameter("action");
		
		if ("update".equals(action)) {
            String newPw = request.getParameter("password");
            String newEmail = request.getParameter("email");
            String newName = request.getParameter("name");
            String newAge = request.getParameter("age");
            String newSex = request.getParameter("sex");

            
            	memberDBCP mDBCP = new memberDBCP();
            	mDBCP.updateMember(uid, newPw, newEmail, newName, newAge, newSex);
                
                // 업데이트 후 새로운 정보를 다시 가져옴
                member se = mDBCP.getMember(uid);
                
                pw = se.getPassword();
                email = se.getEmail();
                name = se.getName();
                age = se.getAge();
                sex = se.getSex();
            
        }
	%>
	
	<form method="post" action="profile.jsp">
        <input type="hidden" name="id" value="<%= uid %>">
        <input type="hidden" name="action" value="update">
        <div>
            <label for="password">Password:</label>
            <input type="password" name="password" value="<%= pw %>">
        </div>
        <div>
            <label for="email">Email:</label>
            <input type="email" name="email" value="<%= email %>">
        </div>
        <div>
            <label for="name">Name:</label>
            <input type="text" name="name" value="<%= name %>">
        </div>
        <div>
            <label for="age">Age:</label>
            <input type="text" name="age" value="<%= age %>">
        </div>
        <div>
            <label for="sex">Sex:</label>
            <input type="text" name="sex" value="<%= sex %>">
        </div>
        <div>
            <button type="submit">Update Profile</button>
        </div>
    </form>
	
	
</body>
</html>